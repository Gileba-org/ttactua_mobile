language: php
php:
- '5.6'
- '7.0'
- '7.1'
- nightly
env:
  matrix:
  - DB=mysql
  global:
  - secure: bPgwlPGZ9bmj2TfioH32tAp08DPt248YWwM3dxdfC3VNyjKEh9kka9oAmtiwrMwEpSwAZwW/uXhUeIMP76PzHdpmdZdS8YRRz31kDhquofym5C+MBqzTTdZhSkq318f+jUrkX2wGtKHk/2UlMVBfUnYiQ3PyDfWQ3ge3de6JTKZWjsZnM6k5UlLnj90YCO4owMKetpF6yDi/rsJ620x+qK1Brkk/9Xh3mcq/xgIXipQc6Zv9SCd2ISiyMVVlXPwjKDuqAJOPDqAVCdS80NZuZbQUhN14abWnye3+Mpfvrbf4cHF0+VyMDbKOo50cD1TWHH7RCvgAhxtH3UeECtAiP+JcHDy4sj6nQI/o8H1g7aTKXOCUge6XDMK/6swBBh5OqGYAaFcRcXR0yP2Uyzlz1IFbc7/ZChNeZaxDf8+TlC87/mNL+pWjDbSKQlnz4qlgINOC6rHeNUL8klTVnB1KYE3EgBvydl2/qYh2H4EpXqtfJ/g96IdpJzBCLtd77t8V31FHQ9Q10VMq2mJbqf4WmvpIDiwbMgMeHT5y++9ROooQQzbmligAYLs0QovcxKrlMPUt5LJYY775Xoqn4XhqKi35Mb/wriHREuEgQkvUIN8dfB3jQb9wtoDOnvPCx+H+XYKVu4bpBk0vKWiQ8aaMJ1SsGhoiCqg5o/ZdOTh/+Jc=
  - secure: HHyaRC57OZC1csL5tIMqt+gpcfkAlIX5LjDTLszVwtXm12bZYL1M/XsZ5L52ORYbjfzELmWo9uLLniMWkefkZwSCxT7SsH4fSfNDoRQ5MEWNnZ6MT17B4H5BbzhtxeCqOum8MB2jNDW+XoRM0bH0+9mCLcljhsJCZlyUjSgdii4sgSUYNvy0/BI/DwHuRae1TJ6k0z0y9M+qONAUJgIdykCfOSUjp+bpC8JKFlILq00LxbR8c7qqi4dl8t043MUpsy9xMWPFCrBE91lyHR1ky2mUxEXd/zwEPvaaMwXxVcSi+RqHLkxfeHUKpccb5kOTGEarWXfdn5VsQYiKzETLC9FS+Y38c91RMLjAlxURHJy2jt5mHSVy6ozJ997JuX1d96iQp8a+3bFverb5csDwwt05V8txqIdmx80gOP4JR8vZAa932/E6f3x0+ZEImkHfYD8DU2udYYaYIz/hdc3XtO4nA3Y25RHnQ25SCdq/wyR6uO3huv3y9xmJmKe9H/cjMa2xKWreR4Khw5/+GwWUWyk4Ou6sCGu0t3LySwbLHJ4qnR3ZyyAE4a0fjv9Ndclzk135AbVByHDADbs5FfKfxRwlNjXo1++xTPjAvw3qU5kGAMrZ9Y+mdzX8CWvMArUgcOBLsVqW8WoUuVQolh+AfO3iVEckytojUgKyGyMZ4T0=
matrix:
  allow_failures:
  - php: nightly
before_script:
- phpenv config-rm xdebug.ini
script:
- phpunit --configuration travisci-phpunit.xml --no-configuration tests
before_deploy:
- cd ..
- zip -r tpl_ttactua_mobile.zip ttactua_mobile -x \*.git\* \*tests\* *travisci-phpunit.xml*
  *.travis.yml* *pkg_ttactua_mobile.xml*
- git clone https://github.com/ndeet/plg_system_less.git plg_system_less
- zip -r plg_system_less.zip plg_system_less -x \*.git\* *.gitignore*
- zip -j pkg_ttactua_mobile tpl_ttactua_mobile.zip plg_system_less.zip ttactua_mobile/pkg_ttactua_mobile.xml
deploy:
  provider: releases
  file:
  - tpl_ttactua_mobile.zip
  - plg_system_less.zip
  - pkg_ttactua_mobile.zip
  skip_cleanup: true
  on:
    tags: true
  api_key:
    secure: YFNRm57erCp0zwqM813pmMP0Y70vjW57ILQ8wf0b601Jfjc58g+5DhpO8CTIVjnB6uqbhqcr0mJQhlBgFUTMFy8DqQ0jR58elIjtE6fFxjtJ+1aL2j+DlM4Bd2AaKxtxCnRrrDXJB3zWDHpDgvvhNImphSCkbuTvcR4MlGMrQvtHqHc6RTUp+k98ir1PS0ShLXincMiJzidwAr8UVd/qS1SPNPjCFXSSPK6qPtigslFBAUxqMs4EjshQZj0oD7okAXviKmQar02T9ydy/+04IHb+71UGITQl2L3RqtzSRPef4fH2w+kI1qQ6NdgjsDjQN8q4yYx97viWkcYys9Dr9MrUn2Q8Lg0OP+2X1hpeab3KuATg2E/5NK2Fagj5CCsu2WOtpzODTMPt9zklPBzpx5R/HoyfW8nFrZqITMlE1RqCg8XDWIoVyrs7qsezEw67FGS0brzIRjTsgUMkexBG3ELsc+7tBCmrw83WVNJU2ywQ3r1BvFwFJ84Or70vlLTCT/hH1yfU3kG2OtvYjJtX800htJ3nVwyhIIz7HE2bzNq+1Jaxf1ul/o8NLsopRuqFdRu9ee1J5DQYpxzly3qlD8McnEnP3xZdpLEQqHkXupdpJKbhuVH/um2CWSQA15YPrEZ6Japsmq+tl2msVpOdpgZwTybQzKFlOM2wQhU+8B4=
after_deploy: curl -T pkg_ttactua_mobile.zip -u $FTP_USER:$FTP_PASSWORD ftp://ftp.gileba.be/
